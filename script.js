// ПОЛУЧАЕМ ССЫЛКУ НА HTML-ЭЛЕМЕНТ КНОПКИ ИЗ DOM
// =============================================
// document.getElementById('AnimateButton') - встроенная браузерная функция,
// которая ищет во всей структуре HTML-документа элемент с атрибутом id="AnimateButton"
// и возвращает ссылку на этот DOM-элемент
// 
// const button - объявляем константную переменную для хранения ссылки на кнопку
// const используется потому что ссылка на кнопку не будет меняться в течение работы программы
const button = document.getElementById('AnimateButton');

// СОЗДАЕМ ФУНКЦИЮ-ОБРАБОТЧИК ДЛЯ ЗАВЕРШЕНИЯ АНИМАЦИИ
// ==================================================
// Эта функция будет вызываться автоматически браузером когда CSS-анимация завершится
// Она удаляет класс анимации с кнопки, возвращая её в исходное состояние
function handleAnimationEnd() {
  // button.classList.remove('SizeUp-animation') - удаляет CSS-класс 'SizeUp-animation' из списка классов кнопки
  // Это важно потому что:
  // 1. После завершения анимации кнопка должна вернуться к нормальному состоянию
  // 2. Если не удалить класс, то при следующем клике анимация может не запуститься правильно
  // 3. Освобождаем элемент от ненужных стилей которые уже выполнили свою задачу
  button.classList.remove('SizeUp-animation');
}

// ДОБАВЛЯЕМ ОСНОВНОЙ ОБРАБОТЧИК СОБЫТИЯ КЛИКА НА КНОПКУ
// ======================================================
// button.addEventListener() - метод который "подписывается" на события элемента
// 'click' - тип события: клик левой кнопкой мыши или касание на мобильном устройстве
// function(event) { ... } - анонимная функция-колбэк которая выполнится при каждом клике
button.addEventListener('click', function(event){
  // ЭТАП 1: ПОДГОТОВКА - УДАЛЕНИЕ КЛАССА АНИМАЦИИ ПЕРЕД ПОВТОРНЫМ ЗАПУСКОМ
  // =====================================================================
  // Сначала удаляем класс анимации если он уже есть на кнопке
  // Это КРИТИЧЕСКИ ВАЖНЫЙ шаг потому что:
  // - Браузеры оптимизируют производительность и не запускают одинаковые анимации подряд
  // - Если класс уже присутствует, новая анимация может не запуститься
  // - Мы как бы "сбрасываем" состояние анимации чтобы подготовить её к повторному запуску
  button.classList.remove('SizeUp-animation');

  // ЭТАП 2: "МАГИЧЕСКИЙ" ПЕРЕЗАПУСК - ПРИНУДИТЕЛЬНЫЙ ПЕРЕРАСЧЕТ МАКЕТА
  // ==================================================================
  // void button.offsetWidth - это известный хак для принудительного перезапуска CSS-анимаций
  // 
  // ПОДРОБНОЕ ОБЪЯСНЕНИЕ МЕХАНИЗМА:
  // 1. offsetWidth - свойство которое содержит вычисленную ширину элемента в пикселях
  // 2. При обращении к любому свойству связанному с размерами/положением (offsetWidth, offsetHeight, getComputedStyle)
  //    браузер вынужден выполнить "reflow" - перерасчет макета страницы
  // 3. Этот перерасчет сбрасывает внутреннее состояние CSS-анимаций в браузере
  // 4. void - оператор который отбрасывает возвращаемое значение, гарантируя что мы не сохраняем ненужные данные
  // 
  // АНАЛОГИЯ: Представьте что это как "встряхнуть" браузер и заставить его забыть про предыдущую анимацию
  void button.offsetWidth;

  // ЭТАП 3: ЗАПУСК - ДОБАВЛЕНИЕ КЛАССА АНИМАЦИИ ДЛЯ ЗАПУСКА ЭФФЕКТА
  // ===============================================================
  // После подготовки и принудительного reflow добавляем класс обратно
  // Теперь браузер воспринимает это как совершенно новую анимацию и запускает её с начала
  // 
  // КАК ЭТО ВЫГЛЯДИТ ДЛЯ ПОЛЬЗОВАТЕЛЯ:
  // - Мгновенная реакция на клик - кнопка начинает "пульсировать"
  // - Плавное увеличение и уменьшение в течение 0.5 секунд
  // - Эффект выглядит свежим и отзывчивым при каждом клике
  button.classList.add('SizeUp-animation');

  // ЭТАП 4: УБОРКА - ПОДПИСКА НА СОБЫТИЕ ЗАВЕРШЕНИЯ АНИМАЦИИ
  // ========================================================
  // Добавляем обработчик который сработает когда анимация завершится
  // 'animationend' - специальное событие которое генерируется браузером когда CSS-анимация доходит до конца
  // 
  // ОСОБЕННОСТИ ПАРАМЕТРА { once: true }:
  // - { once: true } - опция которая указывает что обработчик должен выполниться ТОЛЬКО ОДИН РАЗ
  // - После первого срабатывания обработчик автоматически удаляется браузером
  // - Это предотвращает утечку памяти и накопление множества обработчиков
  // - Без этой опции при каждом клике добавлялся бы новый обработчик
  // 
  // ПРЕИМУЩЕСТВА ПОДХОДА:
  // 1. Автоматическая очистка - не нужно manually удалять обработчик
  // 2. Безопасность - нет риска утечки памяти
  // 3. Простота - код становится чище и понятнее
  button.addEventListener('animationend', handleAnimationEnd, { once: true });
});